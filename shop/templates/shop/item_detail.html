{% extends 'base.html' %}
{% load static %}

{% block title %}{{ item.name }} | –ú–∞–≥–∞–∑–∏–Ω | Taskoro{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'vendor/css/shops.css' %}">
{% endblock %}

{% block content %}
<div class="shop-container">
    <div class="shop-header">
        <h1 class="shop-title">–î–µ—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä–∞</h1>
        <div class="user-currency">
            <div class="currency coins">
                <span class="currency-icon">üí∞</span>
                <span class="currency-amount">{{ request.user.profile.coins }}</span>
            </div>
            <div class="currency gems">
                <span class="currency-icon">üíé</span>
                <span class="currency-amount">{{ request.user.profile.gems }}</span>
            </div>
        </div>
    </div>

    <div class="shop-navigation">
        <ul class="breadcrumbs">
            <li><a href="{% url 'shop:shop' %}">–ú–∞–≥–∞–∑–∏–Ω</a></li>
            <li><a href="{% url 'shop:shop_category' category=item.category %}">{{ item.get_category_display }}</a></li>
            <li class="current">{{ item.name }}</li>
        </ul>
    </div>

    <div class="item-detail-container">
        <div class="item-detail-card">
            <div class="item-image-large">
                {% if item.image %}
                <img src="{{ item.image.url }}" alt="{{ item.name }}">
                {% else %}
                <div class="placeholder-image-large">{{ item.name|first }}</div>
                {% endif %}
            </div>
            
            <div class="item-info">
                <h2 class="item-name">{{ item.name }}</h2>
                
                <div class="item-category">
                    <span class="category-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</span>
                    <span class="category-value">{{ item.get_category_display }}</span>
                </div>
                
                <div class="item-description">
                    <p>{{ item.description }}</p>
                </div>
                
                <div class="item-price-large">
                    {% if item.currency == 'coins' %}
                    <span class="price-icon">üí∞</span>
                    {% else %}
                    <span class="price-icon">üíé</span>
                    {% endif %}
                    <span class="price-amount">{{ item.price }}</span>
                </div>
                
                {% if already_purchased %}
                <div class="already-purchased">
                    <span class="purchased-icon">‚úì</span> –£–∂–µ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–æ
                </div>
                
                {% if is_equipped %}
                <div class="item-status equipped">
                    <span class="status-icon">üë§</span> –í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
                </div>
                <form action="{% url 'shop:unequip_item' item_id=item.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="unequip-button">–°–Ω—è—Ç—å</button>
                </form>
                {% else %}
                <form action="{% url 'shop:equip_item' item_id=item.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="equip-button">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button>
                </form>
                {% endif %}
                
                {% else %}
                <form action="{% url 'shop:purchase_item' item_id=item.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="purchase-button">–ö—É–ø–∏—Ç—å</button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Purchase Confirmation Modal -->
<div id="purchase-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏</h2>
        <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∫—É–ø–∏—Ç—å <span id="item-name-modal">{{ item.name }}</span> –∑–∞ <span id="item-price-modal">{{ item.price }}</span> 
            {% if item.currency == 'coins' %}–º–æ–Ω–µ—Ç{% else %}–∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤{% endif %}?</p>
        <div class="modal-buttons">
            <button id="confirm-purchase" class="confirm-button">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            <button id="cancel-purchase" class="cancel-button">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'vendor/js/shop_detail.js' %}"></script>
{% endblock %}