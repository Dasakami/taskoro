{% extends "base.html" %}

{% block title %}–¢—É—Ä–Ω–∏—Ä—ã | Magic RPG Tracker{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/vendor/css/tournaments.css">
{% endblock %}

{% block content %}
<div class="tournaments-container">
    <div class="tournaments-header reveal">
        <h1 class="text-gradient">–¢—É—Ä–Ω–∏—Ä—ã</h1>
        <p class="tournaments-description">–£—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ —Ç—É—Ä–Ω–∏—Ä–∞—Ö, —Å–æ—Ä–µ–≤–Ω—É–π—Ç–µ—Å—å —Å –¥—Ä—É–≥–∏–º–∏ –û—Ö–æ—Ç–Ω–∏–∫–∞–º–∏ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ —Ü–µ–Ω–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã!</p>
    </div>

    <div class="tournaments-sections">
        <!-- Active Tournaments -->
        <section class="tournaments-section reveal">
            <div class="section-header">
                <h2>–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç—É—Ä–Ω–∏—Ä—ã</h2>
            </div>
            
            {% if active_tournaments %}
            <div class="tournaments-grid">
                {% for tournament in active_tournaments %}
                <div class="tournament-card active">
                    <div class="tournament-status">–ê–∫—Ç–∏–≤–Ω—ã–π</div>
                    <div class="tournament-content">
                        <h3 class="tournament-title">{{ tournament.title }}</h3>
                        <div class="tournament-info">
                            <div class="info-item">
                                <span class="info-icon">‚è±Ô∏è</span>
                                <span class="info-text">–û—Å—Ç–∞–ª–æ—Å—å: {{ tournament.end_date|timeuntil }}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-icon">üë•</span>
                                <span class="info-text">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {{ tournament.get_participants_count }}</span>
                            </div>
                        </div>
                        <div class="tournament-conditions">
                            <p>–£—Å–ª–æ–≤–∏—è: –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–Ω–∏–º—É–º {{ tournament.min_tasks_completed }} –∑–∞–¥–∞—á</p>
                        </div>
                        <div class="tournament-rewards">
                            <div class="reward-item">
                                <span class="reward-icon">‚≠ê</span>
                                <span class="reward-value">{{ tournament.experience_reward }} XP</span>
                            </div>
                            <div class="reward-item">
                                <span class="reward-icon">üí∞</span>
                                <span class="reward-value">{{ tournament.coins_reward }}</span>
                            </div>
                            <div class="reward-item">
                                <span class="reward-icon">üíé</span>
                                <span class="reward-value">{{ tournament.gems_reward }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="tournament-actions">
                        <a href="{% url 'tournaments:tournament_detail' tournament.id %}" class="btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                        {% if tournament.id in user_participations %}
                        <span class="participation-badge">–í—ã —É—á–∞—Å—Ç–≤—É–µ—Ç–µ</span>
                        {% else %}
                        <a href="{% url 'tournaments:tournament_join' tournament.id %}" class="btn btn-secondary">–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å</a>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç. –°–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ!</p>
            </div>
            {% endif %}
        </section>

        <!-- Upcoming Tournaments -->
        <section class="tournaments-section reveal">
            <div class="section-header">
                <h2>–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ —Ç—É—Ä–Ω–∏—Ä—ã</h2>
            </div>
            
            {% if upcoming_tournaments %}
            <div class="tournaments-grid">
                {% for tournament in upcoming_tournaments %}
                <div class="tournament-card upcoming">
                    <div class="tournament-status">–°–∫–æ—Ä–æ</div>
                    <div class="tournament-content">
                        <h3 class="tournament-title">{{ tournament.title }}</h3>
                        <div class="tournament-info">
                            <div class="info-item">
                                <span class="info-icon">üìÖ</span>
                                <span class="info-text">–ù–∞—á–∞–ª–æ: {{ tournament.start_date|date:"d.m.Y" }}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-icon">‚è±Ô∏è</span>
                                <span class="info-text">–î–æ –Ω–∞—á–∞–ª–∞: {{ tournament.start_date|timeuntil }}</span>
                            </div>
                        </div>
                        <div class="tournament-conditions">
                            <p>–£—Å–ª–æ–≤–∏—è: –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–Ω–∏–º—É–º {{ tournament.min_tasks_completed }} –∑–∞–¥–∞—á</p>
                        </div>
                        <div class="tournament-rewards">
                            <div class="reward-item">
                                <span class="reward-icon">‚≠ê</span>
                                <span class="reward-value">{{ tournament.experience_reward }} XP</span>
                            </div>
                            <div class="reward-item">
                                <span class="reward-icon">üí∞</span>
                                <span class="reward-value">{{ tournament.coins_reward }}</span>
                            </div>
                            <div class="reward-item">
                                <span class="reward-icon">üíé</span>
                                <span class="reward-value">{{ tournament.gems_reward }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="tournament-actions">
                        <a href="{% url 'tournament_detail' tournament.id %}" class="btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                        <span class="countdown-badge">–°–∫–æ—Ä–æ</span>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <p>–ù–µ—Ç –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏!</p>
            </div>
            {% endif %}
        </section>

        <!-- Past Tournaments -->
        <section class="tournaments-section reveal">
            <div class="section-header">
                <h2>–ü—Ä–æ—à–µ–¥—à–∏–µ —Ç—É—Ä–Ω–∏—Ä—ã</h2>
            </div>
            
            {% if past_tournaments %}
            <div class="past-tournaments-list">
                {% for tournament in past_tournaments %}
                <div class="past-tournament-item">
                    <div class="past-tournament-info">
                        <h3 class="past-tournament-title">{{ tournament.title }}</h3>
                        <div class="past-tournament-date">
                            {{ tournament.start_date|date:"d.m.Y" }} - {{ tournament.end_date|date:"d.m.Y" }}
                        </div>
                    </div>
                    <div class="past-tournament-actions">
                        <a href="{% url 'tournament_detail' tournament.id %}" class="btn-small">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <p>–ù–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤.</p>
            </div>
            {% endif %}
        </section>
    </div>
</div>
{% endblock %}